<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="fanlychie,范忠云,範宗雲,java,技术,博客"><meta name="baidu-site-verification" content="bQjF64X3Ym"><meta name="keywords" content="fanlychie,范忠云,java,技术,博客,spring,mvc,cloud"><title>基于 POI 和反射机制实现通用读取 Excel 表格数据 | 範宗雲</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.1"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=2.0.1"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">基于 POI 和反射机制实现通用读取 Excel 表格数据</h1><a id="logo" href="/.">範宗雲</a><p class="description">一路走，一路学。面朝大海，望眼欲穿！</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="请输入搜索关键字 ..."></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">基于 POI 和反射机制实现通用读取 Excel 表格数据</h1><div class="post-meta"><span class="date">2015-11-17</span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i> Hits</i></i></span><a href="/post/poi-excel-read.html#comments" class="comment-count"><i id="changyan_parti_unit" data-xid="post/poi-excel-read.html"></i>留言</a></div><div class="post-content"><p>分享一个基于 POI 和反射机制实现的通用的读取 Excel 表格数据工具类，读取 Excel 表格数据只需 2 行代码</p>
<a id="more"></a>
<p><span class="topic">源代码清单</span></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> org.fanlychie.excel;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"><span class="keyword">import</span> java.io.FileInputStream;</div><div class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</div><div class="line"><span class="keyword">import</span> java.io.InputStream;</div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.Date;</div><div class="line"><span class="keyword">import</span> java.util.HashMap;</div><div class="line"><span class="keyword">import</span> java.util.Iterator;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Cell;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Row;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Sheet;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Workbook;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.WorkbookFactory;</div><div class="line"><span class="keyword">import</span> org.fanlychie.util.DynaBean;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * 可进行读操作的 EXCEL 工具类</div><div class="line"> * </div><div class="line"> * <span class="doctag">@author</span> fanlychie</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReadableExcel</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">// 工作表</span></div><div class="line">    <span class="keyword">private</span> Sheet sheet;</div><div class="line">    </div><div class="line">    <span class="comment">// 工作表索引</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> sheetIndex;</div><div class="line"></div><div class="line">    <span class="comment">// Excel 列 与 Bean 属性的顺序映射集</span></div><div class="line">    <span class="keyword">private</span> Map&lt;Integer, String&gt; mapper;</div><div class="line"></div><div class="line">    <span class="comment">// 动态 Bean</span></div><div class="line">    <span class="keyword">private</span> DynaBean dynaBean;</div><div class="line">    </div><div class="line">    <span class="comment">// 最大解析的单元格索引</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> maxColumnIndex;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 构造可读的 Excel 实例</div><div class="line">     * </div><div class="line">     * <span class="doctag">@param</span> file</div><div class="line">     *            Excel 文件</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ReadableExcel</span><span class="params">(File file)</span> </span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            init(<span class="keyword">new</span> FileInputStream(file));</div><div class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 构造可读的 Excel 实例</div><div class="line">     * </div><div class="line">     * <span class="doctag">@param</span> in</div><div class="line">     *            Excel 文件输入流</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ReadableExcel</span><span class="params">(InputStream in)</span> </span>&#123;</div><div class="line">        init(in);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 解析 Excel 文档到一个 List 列表, 约定第一行为标题行, 标题行不被解析</div><div class="line">     * </div><div class="line">     * <span class="doctag">@param</span> beanClass</div><div class="line">     *            简单的 JavaBean 类型, Excel 文档的每一行解析成该类的一个实例</div><div class="line">     * <span class="doctag">@param</span> mapper</div><div class="line">     *            Excel 文档的列映射到 JavaBean 对象的属性列表&lt;br&gt;</div><div class="line">     *            格式串 A：["prop_name1", "prop_name2", ...]&lt;br&gt;</div><div class="line">     *            格式串 B：["1:prop_name1", "2:prop_name2", ...]</div><div class="line">     * <span class="doctag">@return</span> 返回解析 Excel 文档的 List 结果列表</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="function">List&lt;T&gt; <span class="title">asList</span><span class="params">(Class&lt;T&gt; beanClass, String... mapper)</span> </span>&#123;</div><div class="line">        <span class="comment">// 解析映射对照表</span></div><div class="line">        <span class="keyword">this</span>.mapper = parseMapper(mapper);</div><div class="line">        <span class="comment">// 实例化一个动态 Bean 对象</span></div><div class="line">        <span class="keyword">this</span>.dynaBean = <span class="keyword">new</span> DynaBean(beanClass);</div><div class="line">        List&lt;T&gt; beanList = <span class="keyword">new</span> ArrayList&lt;T&gt;();</div><div class="line">        <span class="comment">// 工作表的行集</span></div><div class="line">        Iterator&lt;Row&gt; rows = sheet.iterator();</div><div class="line">        <span class="comment">// 约定第一行为标题行, 不解析</span></div><div class="line">        Row rowOfTitle = rows.next();</div><div class="line">        <span class="comment">// 实际的总的列数</span></div><div class="line">        <span class="keyword">this</span>.maxColumnIndex = rowOfTitle.getPhysicalNumberOfCells();</div><div class="line">        <span class="comment">// 迭代工作表的行集</span></div><div class="line">        <span class="keyword">while</span> (rows.hasNext()) &#123;</div><div class="line">            <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</div><div class="line">            T bean = (T) parseRow(rows.next());</div><div class="line">            beanList.add(bean);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> beanList;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 设置读取的工作表的索引</div><div class="line">     * </div><div class="line">     * <span class="doctag">@param</span> sheetIndex</div><div class="line">     *            工作表的索引</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSheetIndex</span><span class="params">(<span class="keyword">int</span> sheetIndex)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.sheetIndex = sheetIndex;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 初始化工作表</div><div class="line">     * </div><div class="line">     * <span class="doctag">@param</span> in</div><div class="line">     *            Excel 输入流</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(InputStream in)</span> </span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            <span class="comment">// 工作薄</span></div><div class="line">            Workbook workbook = WorkbookFactory.create(in);</div><div class="line">            <span class="comment">// 获取索引指定的工作表</span></div><div class="line">            sheet = workbook.getSheetAt(sheetIndex);</div><div class="line">        &#125; <span class="keyword">catch</span> (Throwable e) &#123;</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 解析 Excel 文档的一行到一个 Bean 的对象里</div><div class="line">     * </div><div class="line">     * <span class="doctag">@param</span> row</div><div class="line">     *            Excel 文档中的行对象</div><div class="line">     * <span class="doctag">@return</span> 返回解析行的 Bean 对象</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> Object <span class="title">parseRow</span><span class="params">(Row row)</span> </span>&#123;</div><div class="line">        <span class="comment">// 创建一个 Bean 的实例</span></div><div class="line">        dynaBean.newBeanInstance();</div><div class="line">        <span class="comment">// 行的单元格列表</span></div><div class="line">        Iterator&lt;Cell&gt; cells = row.cellIterator();</div><div class="line">        <span class="comment">// 迭代单元格列表</span></div><div class="line">        <span class="keyword">while</span> (cells.hasNext()) &#123;</div><div class="line">            <span class="comment">// 单元格</span></div><div class="line">            Cell cell = cells.next();</div><div class="line">            <span class="comment">// 当前的单元格的索引</span></div><div class="line">            <span class="keyword">int</span> columnIndex = cell.getColumnIndex();</div><div class="line">            <span class="comment">// 索引超出最大解析的索引值结束迭代</span></div><div class="line">            <span class="keyword">if</span> (columnIndex &gt;= maxColumnIndex) &#123;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// 单元格映射到 Bean 的属性名称</span></div><div class="line">            String name = mapper.get(columnIndex);</div><div class="line">            <span class="comment">// 如果不在对照表内, 跳过该列</span></div><div class="line">            <span class="keyword">if</span> (name == <span class="keyword">null</span>) &#123;</div><div class="line">                <span class="keyword">continue</span> ;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// 单元格映射到 Bean 的属性类型</span></div><div class="line">            Class&lt;?&gt; type = dynaBean.getFieldType(name);</div><div class="line">            <span class="comment">// 单元格映射到 Bean 的属性的值</span></div><div class="line">            Object value;</div><div class="line">            <span class="keyword">if</span> (type == Date.class) &#123;</div><div class="line">                value = cell.getDateCellValue();</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="comment">// 设置单元格的类型为字符串类型</span></div><div class="line">                cell.setCellType(Cell.CELL_TYPE_STRING);</div><div class="line">                <span class="comment">// 获取单元格字符串内容的值</span></div><div class="line">                String stringCellValue = cell.getStringCellValue();</div><div class="line">                <span class="comment">// 进行数据类型转换</span></div><div class="line">                value = commonTypeConvert(stringCellValue, type);</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// 设置到 Bean 对象</span></div><div class="line">            dynaBean.setFieldValue(name, value);</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// 返回 Bean 的实例</span></div><div class="line">        <span class="keyword">return</span> dynaBean.getBean();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 解析映射的字符串</div><div class="line">     * </div><div class="line">     * <span class="doctag">@param</span> mapper</div><div class="line">     *            格式串 A：["prop_name1", "prop_name2", ...]</div><div class="line">     *            格式串 B：["1:prop_name1", "2:prop_name2", ...]</div><div class="line">     * <span class="doctag">@return</span> 返回解析后的对照表</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> Map&lt;Integer, String&gt; <span class="title">parseMapper</span><span class="params">(String... mapper)</span> </span>&#123;</div><div class="line">        Map&lt;Integer, String&gt; map = <span class="keyword">new</span> HashMap&lt;Integer, String&gt;();</div><div class="line">        String item;</div><div class="line">        <span class="keyword">int</span> length = mapper.length;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; i++) &#123;</div><div class="line">            item = mapper[i];</div><div class="line">            <span class="keyword">if</span> (item.contains(<span class="string">":"</span>)) &#123;</div><div class="line">                String[] items = item.split(<span class="string">":"</span>);</div><div class="line">                map.put(Integer.valueOf(items[<span class="number">0</span>]), items[<span class="number">1</span>]);</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                map.put(i, item);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> map;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 常用的数据类型转换</div><div class="line">     * </div><div class="line">     * <span class="doctag">@param</span> value</div><div class="line">     *            被转换的对象</div><div class="line">     * <span class="doctag">@param</span> type</div><div class="line">     *            期望得到的类型</div><div class="line">     * <span class="doctag">@return</span> 返回转换后的数据类型对象</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> Object <span class="title">commonTypeConvert</span><span class="params">(String value, Class&lt;?&gt; type)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (type == String.class) &#123;</div><div class="line">            <span class="keyword">return</span> value;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (type == Character.TYPE || type == Character.class) &#123;</div><div class="line">            <span class="keyword">return</span> value.charAt(<span class="number">0</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (type == Boolean.TYPE || type == Boolean.class) &#123;</div><div class="line">            <span class="comment">// 真值</span></div><div class="line">            <span class="keyword">if</span> (value == <span class="string">"1"</span> || value.equals(<span class="string">"是"</span>)</div><div class="line">                    || value.equalsIgnoreCase(<span class="string">"Y"</span>)</div><div class="line">                    || value.equalsIgnoreCase(<span class="string">"YES"</span>)</div><div class="line">                    || value.equalsIgnoreCase(<span class="string">"T"</span>)</div><div class="line">                    || value.equalsIgnoreCase(<span class="string">"TRUE"</span>)) &#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// 假值</span></div><div class="line">            <span class="keyword">if</span> (value == <span class="string">"0"</span> || value.equals(<span class="string">"否"</span>)</div><div class="line">                    || value.equalsIgnoreCase(<span class="string">"N"</span>)</div><div class="line">                    || value.equalsIgnoreCase(<span class="string">"NO"</span>)</div><div class="line">                    || value.equalsIgnoreCase(<span class="string">"F"</span>)</div><div class="line">                    || value.equalsIgnoreCase(<span class="string">"FALSE"</span>)) &#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// 解析成双精度类型</span></div><div class="line">        Double objVal = Double.valueOf(value);</div><div class="line">        <span class="comment">// 以下均基于双精度数据上作的类型转换</span></div><div class="line">        <span class="keyword">if</span> (type == Byte.TYPE || type == Byte.class) &#123;</div><div class="line">            <span class="keyword">return</span> objVal.byteValue();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (type == Short.TYPE || type == Short.class) &#123;</div><div class="line">            <span class="keyword">return</span> objVal.shortValue();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (type == Integer.TYPE || type == Integer.class) &#123;</div><div class="line">            <span class="keyword">return</span> objVal.intValue();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (type == Long.TYPE || type == Long.class) &#123;</div><div class="line">            <span class="keyword">return</span> objVal.longValue();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (type == Float.TYPE || type == Float.class) &#123;</div><div class="line">            <span class="keyword">return</span> objVal.floatValue();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (type == Double.TYPE || type == Double.class) &#123;</div><div class="line">            <span class="keyword">return</span> objVal;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ClassCastException(<span class="string">"Cannot cast java.lang.String to "</span> + type.getName());</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><span class="topic">POI 依赖</span></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-ooxml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div></pre></td></tr></table></figure>
<p><span class="topic">测试对象清单</span></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> String name;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> String sex;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> local;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> Date birthday;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> id;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.id = id;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.name = name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isLocal</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> local;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLocal</span><span class="params">(<span class="keyword">boolean</span> local)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.local = local;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">getBirthday</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> birthday;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBirthday</span><span class="params">(Date birthday)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.birthday = birthday;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSex</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> sex;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.sex = sex;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getBirthdayStr</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (birthday == <span class="keyword">null</span>) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd"</span>).format(birthday);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> id + <span class="string">"\t"</span> + name + <span class="string">"\t"</span> + sex + <span class="string">"\t"</span> + local + <span class="string">"\t"</span> + getBirthdayStr();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><span class="topic">测试 Excel 表格数据清单</span></p>
<p><img src="http://i.imgur.com/GIfVOmK.png" alt=""></p>
<p><span class="topic">测试清单1</span></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">	</div><div class="line">    File excelFile = <span class="keyword">new</span> File(<span class="string">"src/test/resources/person_excel.xlsx"</span>);</div><div class="line">    </div><div class="line">    <span class="comment">// 创建一个可读的 Excel 对象</span></div><div class="line">    ReadableExcel excel = <span class="keyword">new</span> ReadableExcel(excelFile);</div><div class="line">    </div><div class="line">    <span class="comment">// 解析 Excel 数据为 JavaBean 对象</span></div><div class="line">    List&lt;Person&gt; persons = excel.asList(Person.class, <span class="string">"id"</span>, <span class="string">"name"</span>, <span class="string">"sex"</span>, <span class="string">"local"</span>, <span class="string">"birthday"</span>);</div><div class="line">    </div><div class="line">    <span class="keyword">for</span> (Person person : persons) &#123;</div><div class="line">    	</div><div class="line">        System.out.println(person);</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>解析语法1：[&quot;id&quot;, &quot;name&quot;, &quot;sex&quot;, &quot;local&quot;, &quot;birthday&quot;] 从左至右依次对应 Excel 表格的列数据</p>
<p><span class="topic">测试结果</span></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">1	刘一	男	false	1990-04-02</div><div class="line"></div><div class="line">2	陈二	男	false	1991-08-01</div><div class="line"></div><div class="line">3	张三	女	false	1990-04-01</div><div class="line"></div><div class="line">4	李四	女	false	1992-05-04</div><div class="line"></div><div class="line">5	王五	女	true	1992-05-02</div><div class="line"></div><div class="line">6	赵六	男	true	1991-07-06</div><div class="line"></div><div class="line">7	孙七	女	true	1990-09-03</div><div class="line"></div><div class="line">8	周八	女	false	1990-03-05</div><div class="line"></div><div class="line">9	吴九	男	true	1993-01-03</div></pre></td></tr></table></figure>
<p><span class="topic">测试清单2</span></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">	</div><div class="line">    File excelFile = <span class="keyword">new</span> File(<span class="string">"src/test/resources/person_excel.xlsx"</span>);</div><div class="line">    </div><div class="line">    <span class="comment">// 创建一个可读的 Excel 对象</span></div><div class="line">    ReadableExcel excel = <span class="keyword">new</span> ReadableExcel(excelFile);</div><div class="line">    </div><div class="line">    <span class="comment">// 解析 Excel 数据为 JavaBean 对象</span></div><div class="line">    List&lt;Person&gt; persons = excel.asList(Person.class, <span class="string">"0:id"</span>, <span class="string">"2:name"</span>, <span class="string">"1:sex"</span>);</div><div class="line">    </div><div class="line">    <span class="keyword">for</span> (Person person : persons) &#123;</div><div class="line">    	</div><div class="line">        System.out.println(person);</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>解析语法2：[&quot;0:id&quot;, &quot;2:name&quot;, &quot;1:sex&quot;] 只提取想要的列的数据（0 代表第 1 列）</p>
<p>&quot;2:name&quot; 表示将 Excel 表格第 3 列的数据解析成 JavaBean 对象的 name 属性的值</p>
<p>[&quot;0:id&quot;, &quot;2:name&quot;, &quot;1:sex&quot;] 等效于 [&quot;id&quot;, &quot;2:name&quot;, &quot;1:sex&quot;]，其余类似，可灵活提取表格数据</p>
<p>场景：</p>
<p>我们公司使用的短信供应商目前已有 3 家，在统计数据的时候，需要先在供应商短信系统导出短信</p>
<p>消息的 Excel 文档然后统计相关信息，但是不同供应商导出的 Excel 模板文件格式不一致，因此衍生</p>
<p>了这种解析 Excel 表格数据的处理方法。</p>
<p>假设供应商 A 导出的手机号码在第 2 列，供应商 B 导出的手机号码在第 3 列，我们可以这样做：</p>
<p>供应商 A 使用 &quot;1:mobile&quot;</p>
<p>供应商 B 使用 &quot;2:mobile&quot;</p>
<p>这样一来，我们只需要根据不同的供应商传整数值定向解析列的数据即可，这样可以适配多个不同</p>
<p>的 Excel 模板，只要 2 行代码完成解析工作</p>
<p>注：非公开公司代码，纯为个人积累及思考编码实现</p>
<p><span class="topic">测试结果</span></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">1	男	刘一	false	null</div><div class="line"></div><div class="line">2	男	陈二	false	null</div><div class="line"></div><div class="line">3	女	张三	false	null</div><div class="line"></div><div class="line">4	女	李四	false	null</div><div class="line"></div><div class="line">5	女	王五	false	null</div><div class="line"></div><div class="line">6	男	赵六	false	null</div><div class="line"></div><div class="line">7	女	孙七	false	null</div><div class="line"></div><div class="line">8	女	周八	false	null</div><div class="line"></div><div class="line">9	男	吴九	false	null</div></pre></td></tr></table></figure>
<p>[&quot;0:id&quot;, &quot;2:name&quot;, &quot;1:sex&quot;] 这里故意将 name 和 sex 倒了过来，将第 2 列解析成 sex，第 3 列解析成 name，以示区分</p>
</div><div class="tags"><a href="/tags/工具类/">工具类</a></div><div class="post-share"></div><div class="post-nav"><a href="/post/poi-excel-write.html" class="pre">基于 POI 和反射机制实现通用写出 Excel 文档文件</a><a href="/post/java-reflect-bean.html" class="next">基于反射机制实现动态操纵 JavaBean</a></div><div id="comments"><div id="SOHUCS" sid="post/poi-excel-read.html"></div></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">文章目录</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/post/springmvc-dubbo-mybatis-with-cat.html">springmvc+dubbo+mybatis 接入大众点评 CAT 监控平台</a></li><li class="post-list-item"><a class="post-list-link" href="/post/cat-setup.html">搭建大众点评CAT监控平台</a></li><li class="post-list-item"><a class="post-list-link" href="/post/mysql-select-optimization.html">MySQL 查询优化</a></li><li class="post-list-item"><a class="post-list-link" href="/post/mysql-index.html">MySQL 索引</a></li><li class="post-list-item"><a class="post-list-link" href="/post/mysql-explain.html">MySQL Explain 分析 SQL 的执行计划</a></li><li class="post-list-item"><a class="post-list-link" href="/post/mysql-query-cache.html">MySQL 查询缓存</a></li><li class="post-list-item"><a class="post-list-link" href="/post/mysql57-resolve-cmd-net-command.html">解决命令行无法关闭和启动MySQL服务的问题</a></li><li class="post-list-item"><a class="post-list-link" href="/post/mysql57-setup.html">MySQL5.7 安装</a></li><li class="post-list-item"><a class="post-list-link" href="/post/linux-commands.html">程序员必知必会的 Linux Shell 命令</a></li><li class="post-list-item"><a class="post-list-link" href="/post/fastdfs-client.html">FastDFS 客户端工具类</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/缓存/" style="font-size: 15px;">缓存</a> <a href="/tags/MQ/" style="font-size: 15px;">MQ</a> <a href="/tags/开发工具包/" style="font-size: 15px;">开发工具包</a> <a href="/tags/Dubbo/" style="font-size: 15px;">Dubbo</a> <a href="/tags/监控/" style="font-size: 15px;">监控</a> <a href="/tags/FastDFS/" style="font-size: 15px;">FastDFS</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/Java8/" style="font-size: 15px;">Java8</a> <a href="/tags/Eclipse/" style="font-size: 15px;">Eclipse</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/表达式/" style="font-size: 15px;">表达式</a> <a href="/tags/CAS/" style="font-size: 15px;">CAS</a> <a href="/tags/工具类/" style="font-size: 15px;">工具类</a> <a href="/tags/Tomcat/" style="font-size: 15px;">Tomcat</a> <a href="/tags/Jenkins/" style="font-size: 15px;">Jenkins</a> <a href="/tags/JPA/" style="font-size: 15px;">JPA</a> <a href="/tags/ActiveMQ/" style="font-size: 15px;">ActiveMQ</a> <a href="/tags/Memcached/" style="font-size: 15px;">Memcached</a> <a href="/tags/数据库/" style="font-size: 15px;">数据库</a> <a href="/tags/MySQL/" style="font-size: 15px;">MySQL</a> <a href="/tags/Nginx/" style="font-size: 15px;">Nginx</a> <a href="/tags/网络爬虫/" style="font-size: 15px;">网络爬虫</a> <a href="/tags/Redis/" style="font-size: 15px;">Redis</a> <a href="/tags/Spring-Boot/" style="font-size: 15px;">Spring Boot</a> <a href="/tags/RabbitMQ/" style="font-size: 15px;">RabbitMQ</a> <a href="/tags/Solr/" style="font-size: 15px;">Solr</a> <a href="/tags/Spring-Cloud/" style="font-size: 15px;">Spring Cloud</a> <a href="/tags/MyBatis/" style="font-size: 15px;">MyBatis</a> <a href="/tags/Spring/" style="font-size: 15px;">Spring</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/Zookeeper/" style="font-size: 15px;">Zookeeper</a> <a href="/tags/Thymeleaf/" style="font-size: 15px;">Thymeleaf</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">08月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">07月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">04月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">03月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">11月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">09月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">08月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">07月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">06月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">05月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">04月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">02月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">01月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">10月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">09月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">01月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">12月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">11月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">10月 2015</a></li></ul></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">网站地图</a> | <a href="/atom.xml">订阅</a> |<span>主题<a rel="nofollow" target="_blank" href="https://hexo.io/zh-cn/"> Hexo</a><a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake</a> |</span><span>本站总访问量：<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>次</span></p></div></div></div><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?4e375539c063ce29112e53dea9f27aae";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="/js/search.json.js?v=2.0.1"></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.1" async></script><script>window._config = { showScore: true };
(function(){ 
  var appid = 'cyt5nPNL8'; 
  var conf = '5fe2e421f26b9cd1b7c459f7417c85b6'; 
  var width = window.innerWidth || document.documentElement.clientWidth; 
  var nodes =document.getElementsByTagName("head")[0]||document.head||document.documentElement;
  if (width < 960) { 
    window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>'); } 
  else { 
    var loadJs=function(d,a){
      var b=document.createElement("script");b.setAttribute("type","text/javascript");
      b.setAttribute("charset","UTF-8");
      b.setAttribute("src",d);
      if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}
      nodes.appendChild(b)
    };
    loadJs("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})}); 
  } 
  var loadCss = function(cssString){  
    var style=document.createElement("style");  
    style.setAttribute("type", "text/css");  
    if(style.styleSheet){// IE  
        style.styleSheet.cssText = cssString;  
    } else {// w3c  
        var cssText = document.createTextNode(cssString);  
        style.appendChild(cssText);  
    }
    nodes.appendChild(style);
  }
  window.onload=function(){loadCss('.module-hot-topic, .module-cmt-float-bar { display: none !important; } #SOHUCS #SOHU_MAIN .module-cmt-box .post-wrap-w .wrap-action-w .cbox-prompt-w span.prompt-empty-w, #SOHUCS #SOHU_MAIN .module-cmt-float-bar .wrap-cont-w .cont-form-w .form-text-w span.text-null, #SOHUCS #SOHU_MAIN .module-cmt-float-bar .wrap-cont-w .cont-minwidth-w div.cont-comment-w a.comment-link-w, #SOHUCS #SOHU_MAIN .module-cmt-float-bar .wrap-cont-w .cont-minwidth-w div.cont-comment-w span.comment-text-w, #SOHUCS #SOHU_MAIN .module-cmt-footer .section-service-w div.service-wrap-w a:hover, #SOHUCS #SOHU_MAIN .module-cmt-header .section-cbox-w .block-head-w div.header-login, #SOHUCS #SOHU_MAIN .module-cmt-header .section-title-w .title-user-w .user-wrap-w span.wrap-name-w, #SOHUCS #SOHU_MAIN .module-cmt-list .action-click-gw span.click-disable-eg a em.icon-name-bg, #SOHUCS #SOHU_MAIN .module-cmt-list .block-title-gw ul li div.title-name-gw, #SOHUCS #SOHU_MAIN .module-cmt-list .cmt-list-type .cmt-list-number .comment-number span.cy-number, #SOHUCS #SOHU_MAIN .module-cmt-list .cmt-list-type .cmt-list-number span.comment-number, #SOHUCS #SOHU_MAIN .module-cmt-list .cmt-list-type .type-lists li.active, #SOHUCS #SOHU_MAIN .module-cmt-list .msg-wrap-gw .wrap-action-gw .action-click-gw span a:hover, #SOHUCS #SOHU_MAIN .module-cmt-list .picture-box-gw div.box-action-gw a:hover, #SOHUCS #SOHU_MAIN .module-cmt-list .wrap-action-gw .action-click-gw span a:hover em.icon-name-bg, #SOHUCS #SOHU_MAIN .module-cmt-list .wrap-user-gw span.user-name-gw a { color: #40759b !important; } #SOHUCS #SOHU_MAIN .module-cmt-box .post-wrap-w .post-wrap-border-t div.post-wrap-border-t-r, #SOHUCS #SOHU_MAIN .module-cmt-box .post-wrap-w div.post-wrap-border-l, #SOHUCS #SOHU_MAIN .module-cmt-box .post-wrap-w div.post-wrap-border-r { display: none !important; } #SOHUCS #SOHU_MAIN .module-cmt-box .post-wrap-w .post-wrap-border-t div.post-wrap-border-t-l { background: #FFF !important; top: -2px !important; } #SOHUCS #SOHU_MAIN .module-cmt-box .post-wrap-w .wrap-action-w .action-function-w .uploading-wrapper-dw div.wrapper-image-dw, #SOHUCS #SOHU_MAIN .module-cmt-box .post-wrap-w div.post-wrap-main, #SOHUCS #SOHU_MAIN .module-cmt-float-bar .wrap-cont-w .cont-form-w div.form-text-w, #SOHUCS #SOHU_MAIN .module-cmt-header .section-cbox-w .block-head-w div.header-login, #SOHUCS #SOHU_MAIN .module-cmt-list .module-cmt-box .post-wrap-w div.post-wrap-main { border: 1px solid #e6e6e6 !important; border-radius: 20px 20px 20px 20px; margin: 0 !important; } #SOHUCS #SOHU_MAIN .module-cmt-box .post-wrap-w .wrap-action-w .action-issue-w .issue-btn-w a .btn-fw { width: 130px !important; height: 34px !important; line-height: 33px !important; font-size: 17px !important; background: transparent !important; } #SOHUCS #SOHU_MAIN .module-cmt-box .post-wrap-w .wrap-action-w .action-issue-w .issue-btn-w a .btn-fw:before { content: "发表评论"; display: block; border-radius: 20px; width: 100%; height: 100%; color: #FFF; background: #5483b1; -webkit-box-shadow: 0 -1px 4px #5483b1 inset; box-shadow: 0 -1px 10px #5483b1 inset; } #SOHUCS #SOHU_MAIN .module-cmt-box .post-wrap-w .wrap-action-w .action-issue-w .issue-btn-w a:hover .btn-fw:before { color: #40759b; background: #FFF; } #SOHUCS #SOHU_MAIN .module-cmt-list .cmt-list-type .type-lists li{ background: none !important; border-bottom: 1px solid #e6e6e6; } #SOHUCS #SOHU_MAIN .module-cmt-list .cmt-list-type .type-lists li.active { border: 1px solid #e6e6e6; border-radius: 10px 10px 0 0; border-bottom: none; } #SOHUCS #SOHU_MAIN .module-cmt-list .block-title-gw ul li .title-name-gw div.title-name-gw-tag { background: #5483b1 !important; border-radius: 3px; } #SOHUCS #SOHU_MAIN .module-cmt-list .cmt-list-type div.cmt-list-border { background-color: #e6e6e6 !important; } #SOHUCS #SOHU_MAIN .module-cmt-notice ul.nt-list li.nt-item{ border: 1px solid #e6e6e6 !important; } #SOHUCS #SOHU_MAIN .module-cmt-notice ul.nt-list li.nt-item .nt-logo { text-align: center; line-height: 40px; border-radius: 50% !important; background: #e6e6e6 !important; } #SOHUCS #SOHU_MAIN .module-cmt-notice ul.nt-list li.nt-item .nt-logo:before { content: "畅"; font-size: 22px; color: #FFF; } #SOHUCS #SOHU_MAIN .module-cmt-notice ul.nt-list li.nt-item a.nt-text, #SOHUCS #SOHU_MAIN .module-cmt-notice ul.nt-list li.nt-item a.nt-text i { color: #5483b1 !important; }#SOHUCS #SOHU_MAIN .module-cmt-header .section-title-w .title-user-w .user-wrap-w{background:#FFF !important;}');};
})();</script><script src="https://assets.changyan.sohu.com/upload/plugins/plugins.count.js"></script></body></html>