<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="fanlychie,范忠云,範宗雲,java,技术,博客"><meta name="baidu-site-verification" content="bQjF64X3Ym"><meta name="keywords" content="fanlychie,范忠云,java,技术,博客,spring,mvc,cloud"><title>基于 POI 和反射机制实现通用写出 Excel 文档文件 | 範宗雲</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.1"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=2.0.1"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">基于 POI 和反射机制实现通用写出 Excel 文档文件</h1><a id="logo" href="/.">範宗雲</a><p class="description">一路走，一路学。面朝大海，望眼欲穿！</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="请输入搜索关键字 ..."></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">基于 POI 和反射机制实现通用写出 Excel 文档文件</h1><div class="post-meta"><span class="date">2015-11-18</span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i> Hits</i></i></span><a href="/post/poi-excel-write.html#comments" class="comment-count"><i id="changyan_parti_unit" data-xid="post/poi-excel-write.html"></i>留言</a></div><div class="post-content"><p>分享一个基于 POI 和反射机制实现的通用的写出 Excel 文档文件工具类，及简写出数据到 Excel 文档</p>
<a id="more"></a>
<p><span class="topic">源代码清单</span></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> org.fanlychie.excel;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</div><div class="line"><span class="keyword">import</span> java.io.FileOutputStream;</div><div class="line"><span class="keyword">import</span> java.io.IOException;</div><div class="line"><span class="keyword">import</span> java.io.OutputStream;</div><div class="line"><span class="keyword">import</span> java.util.Date;</div><div class="line"><span class="keyword">import</span> java.util.HashMap;</div><div class="line"><span class="keyword">import</span> java.util.LinkedHashMap;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.CellStyle;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Font;</div><div class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.IndexedColors;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFCell;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFRow;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</div><div class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</div><div class="line"><span class="keyword">import</span> org.fanlychie.util.DynaBean;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * 可进行写操作的 EXCEL 工具类</div><div class="line"> * </div><div class="line"> * <span class="doctag">@author</span> fanlychie</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WritableExcel</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="comment">// 数据列表</span></div><div class="line">    <span class="keyword">private</span> List&lt;?&gt; list;</div><div class="line">    </div><div class="line">    <span class="comment">// 属性名称集</span></div><div class="line">    <span class="keyword">private</span> String[] props;</div><div class="line">    </div><div class="line">    <span class="comment">// 标题集</span></div><div class="line">    <span class="keyword">private</span> String[] title;</div><div class="line"></div><div class="line">    <span class="comment">// 动态 Bean</span></div><div class="line">    <span class="keyword">private</span> DynaBean dynaBean;</div><div class="line">    </div><div class="line">    <span class="comment">// 工作表</span></div><div class="line">    <span class="keyword">private</span> XSSFSheet sheet;</div><div class="line">    </div><div class="line">    <span class="comment">// 工作表的名称</span></div><div class="line">    <span class="keyword">private</span> String sheetName;</div><div class="line">    </div><div class="line">    <span class="comment">// 工作簿</span></div><div class="line">    <span class="keyword">private</span> XSSFWorkbook workbook;</div><div class="line">    </div><div class="line">    <span class="comment">// 数据格式</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;Class&lt;?&gt;, String&gt; dataFormat;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 构造一个可写的 Excel 实例</div><div class="line">     * </div><div class="line">     * <span class="doctag">@param</span> list</div><div class="line">     *            数据列表</div><div class="line">     * <span class="doctag">@param</span> mapper</div><div class="line">     *            数据对象的属性名称与Excel文档标题之间的映射关系</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WritableExcel</span><span class="params">(List&lt;?&gt; list, LinkedHashMap&lt;String, String&gt; mapper)</span> </span>&#123;</div><div class="line">        init(list, mapper);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 写出到文件</div><div class="line">     * </div><div class="line">     * <span class="doctag">@param</span> file</div><div class="line">     *            文件对象</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">write</span><span class="params">(File file)</span> </span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            <span class="keyword">return</span> write(<span class="keyword">new</span> FileOutputStream(file));</div><div class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 写出到输出流</div><div class="line">     * </div><div class="line">     * <span class="doctag">@param</span> out</div><div class="line">     *            输出流</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">write</span><span class="params">(OutputStream out)</span> </span>&#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            <span class="comment">// 创建工作表</span></div><div class="line">            sheet = workbook.createSheet(sheetName);</div><div class="line">            <span class="comment">// 构建并填充标题行</span></div><div class="line">            fillTitleRow();</div><div class="line">            <span class="comment">// 主体行的索引</span></div><div class="line">            <span class="keyword">int</span> rowIndex = <span class="number">1</span>;</div><div class="line">            <span class="keyword">for</span> (Object bean : list) &#123;</div><div class="line">                <span class="comment">// 创建并填充行</span></div><div class="line">                fillCreatedRow(rowIndex++, bean);</div><div class="line">            &#125;</div><div class="line">            workbook.write(out);</div><div class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        &#125; <span class="keyword">catch</span> (Throwable e) &#123;</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</div><div class="line">        &#125; <span class="keyword">finally</span> &#123;</div><div class="line">            <span class="keyword">try</span> &#123;</div><div class="line">                <span class="keyword">if</span> (out != <span class="keyword">null</span>) &#123;</div><div class="line">                    out.close();</div><div class="line">                &#125;</div><div class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;&#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 设置工作表的名称, 默认名称 Sheet1</div><div class="line">     * </div><div class="line">     * <span class="doctag">@param</span> sheetName</div><div class="line">     *            工作表的名称</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSheetName</span><span class="params">(String sheetName)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.sheetName = sheetName;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 设置日期格式, 默认格式 yyyy-MM-dd</div><div class="line">     * </div><div class="line">     * <span class="doctag">@param</span> dateFormat</div><div class="line">     *            日期格式</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDateFormat</span><span class="params">(String dateFormat)</span> </span>&#123;</div><div class="line">        dataFormat.put(Date.class, dateFormat);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 初始化</div><div class="line">     * </div><div class="line">     * <span class="doctag">@param</span> list</div><div class="line">     *            数据列表</div><div class="line">     * <span class="doctag">@param</span> mapper</div><div class="line">     *            数据对象的属性名称与Excel文档标题之间的映射关系</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(List&lt;?&gt; list, LinkedHashMap&lt;String, String&gt; mapper)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.list = list;</div><div class="line">        <span class="keyword">int</span> index = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> size = mapper.size();</div><div class="line">        props = <span class="keyword">new</span> String[size];</div><div class="line">        title = <span class="keyword">new</span> String[size];</div><div class="line">        <span class="comment">// 迭代取出属性名称集和标题集</span></div><div class="line">        <span class="keyword">for</span> (String prop : mapper.keySet()) &#123;</div><div class="line">            props[index] = prop;</div><div class="line">            title[index] = mapper.get(prop);</div><div class="line">            index++;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// 工作簿</span></div><div class="line">        <span class="keyword">this</span>.workbook = <span class="keyword">new</span> XSSFWorkbook();</div><div class="line">        <span class="comment">// 动态 Bean</span></div><div class="line">        <span class="keyword">this</span>.dynaBean = <span class="keyword">new</span> DynaBean(list.get(<span class="number">0</span>).getClass());</div><div class="line">        <span class="comment">// 默认的工作表名称</span></div><div class="line">        <span class="keyword">this</span>.sheetName = <span class="string">"Sheet1"</span>;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 构建并填充标题行</div><div class="line">     * </div><div class="line">     * <span class="doctag">@throws</span> Throwable</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">fillTitleRow</span><span class="params">()</span> <span class="keyword">throws</span> Throwable </span>&#123;</div><div class="line">        <span class="comment">// 单元格索引</span></div><div class="line">        <span class="keyword">int</span> cellIndex = <span class="number">0</span>;</div><div class="line">        <span class="comment">// 单元格宽度</span></div><div class="line">        <span class="keyword">int</span> cellWidth = <span class="number">18</span> * <span class="number">256</span>;</div><div class="line">        <span class="comment">// 创建一行</span></div><div class="line">        XSSFRow row = sheet.createRow(<span class="number">0</span>);</div><div class="line">        <span class="comment">// 设置行高</span></div><div class="line">        row.setHeightInPoints(<span class="number">25</span>);</div><div class="line">        <span class="comment">// 标题行样式</span></div><div class="line">        CellStyle style = getTitleCellStyle();</div><div class="line">        <span class="comment">// 迭代标题集</span></div><div class="line">        <span class="keyword">for</span> (String text : title) &#123;</div><div class="line">            <span class="comment">// 设置宽度</span></div><div class="line">            sheet.setColumnWidth(cellIndex, cellWidth);</div><div class="line">            <span class="comment">// 创建单元格</span></div><div class="line">            XSSFCell cell = row.createCell(cellIndex++);</div><div class="line">            <span class="comment">// 设置单元格样式</span></div><div class="line">            cell.setCellStyle(style);</div><div class="line">            <span class="comment">// 设置单元格的值</span></div><div class="line">            cell.setCellValue(text);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 创建并填充行</div><div class="line">     * </div><div class="line">     * <span class="doctag">@param</span> index</div><div class="line">     *            行的索引</div><div class="line">     * <span class="doctag">@param</span> bean</div><div class="line">     *            填充行的对象</div><div class="line">     * <span class="doctag">@throws</span> Throwable</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">fillCreatedRow</span><span class="params">(<span class="keyword">int</span> index, Object bean)</span> <span class="keyword">throws</span> Throwable </span>&#123;</div><div class="line">        <span class="comment">// 单元格索引</span></div><div class="line">        <span class="keyword">int</span> cellIndex = <span class="number">0</span>;</div><div class="line">        <span class="comment">// 创建一行</span></div><div class="line">        XSSFRow row = sheet.createRow(index);</div><div class="line">        <span class="comment">// 设置行高</span></div><div class="line">        row.setHeightInPoints(<span class="number">20</span>);</div><div class="line">        <span class="comment">// 迭代 Bean 属性集</span></div><div class="line">        <span class="keyword">for</span> (String prop : props) &#123;</div><div class="line">            <span class="comment">// 属性的值</span></div><div class="line">            Object value = dynaBean.getFieldValue(bean, prop);</div><div class="line">            <span class="comment">// 属性类型</span></div><div class="line">            Class&lt;?&gt; type = dynaBean.getFieldType(prop);</div><div class="line">            <span class="comment">// 创建单元格</span></div><div class="line">            XSSFCell cell = row.createCell(cellIndex++);</div><div class="line">            <span class="comment">// 值为空</span></div><div class="line">            <span class="keyword">if</span> (value == <span class="keyword">null</span>) &#123;</div><div class="line">                <span class="comment">// 设置为空串</span></div><div class="line">                cell.setCellValue(<span class="string">""</span>);</div><div class="line">                <span class="comment">// 单元格样式</span></div><div class="line">                cell.setCellStyle(getBodyCellStyle(String.class));</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="comment">// 按类型设值</span></div><div class="line">                <span class="keyword">if</span> (type == Boolean.TYPE || type == Boolean.class) &#123;</div><div class="line">                    <span class="keyword">boolean</span> boolValue = Boolean.parseBoolean(value.toString());</div><div class="line">                    cell.setCellValue(boolValue);</div><div class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((Number.class.isAssignableFrom(type) || type.isPrimitive())</div><div class="line">                        &amp;&amp; type != Byte.TYPE &amp;&amp; type != Character.TYPE) &#123;</div><div class="line">                    <span class="keyword">double</span> doubleValue = Double.parseDouble(value.toString());</div><div class="line">                    cell.setCellValue(doubleValue);</div><div class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type == Date.class) &#123;</div><div class="line">                    Date dateValue = (Date) value;</div><div class="line">                    cell.setCellValue(dateValue);</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    cell.setCellValue(value.toString());</div><div class="line">                &#125;</div><div class="line">                <span class="comment">// 单元格样式</span></div><div class="line">                cell.setCellStyle(getBodyCellStyle(type));</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 主体单元格样式</div><div class="line">     * </div><div class="line">     * <span class="doctag">@param</span> type</div><div class="line">     *            单元格填充的数据的类型</div><div class="line">     * <span class="doctag">@return</span> CellStyle</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> CellStyle <span class="title">getBodyCellStyle</span><span class="params">(Class&lt;?&gt; type)</span> </span>&#123;</div><div class="line"></div><div class="line">        <span class="comment">// 单元格样式</span></div><div class="line">        CellStyle style = workbook.createCellStyle();</div><div class="line">        </div><div class="line">        <span class="comment">// 单元格数据格式</span></div><div class="line">        String cellDataFormat = dataFormat.get(type);</div><div class="line">        <span class="keyword">if</span> (cellDataFormat == <span class="keyword">null</span>) &#123;</div><div class="line">            cellDataFormat = dataFormat.get(String.class);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="comment">// 水平居中</span></div><div class="line">        style.setAlignment(CellStyle.ALIGN_CENTER);</div><div class="line">        <span class="comment">// 垂直居中</span></div><div class="line">        style.setVerticalAlignment(CellStyle.VERTICAL_CENTER);</div><div class="line">        </div><div class="line">        <span class="comment">// 背景颜色</span></div><div class="line">        setBackgroundColor(style, IndexedColors.LIGHT_TURQUOISE.index);</div><div class="line"></div><div class="line">        <span class="comment">// 字体</span></div><div class="line">        style.setFont(getFont(<span class="number">11</span>, IndexedColors.GREY_50_PERCENT.index));</div><div class="line"></div><div class="line">        <span class="comment">// 数据格式</span></div><div class="line">        style.setDataFormat(workbook.createDataFormat().getFormat(cellDataFormat));</div><div class="line"></div><div class="line">        <span class="comment">// 自动换行</span></div><div class="line">        style.setWrapText(<span class="keyword">true</span>);</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> style;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 标题行样式</div><div class="line">     * </div><div class="line">     * <span class="doctag">@return</span> CellStyle</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> CellStyle <span class="title">getTitleCellStyle</span><span class="params">()</span> </span>&#123;</div><div class="line">        </div><div class="line">        <span class="comment">// 单元格样式</span></div><div class="line">        CellStyle style = workbook.createCellStyle();</div><div class="line">        </div><div class="line">        <span class="comment">// 水平居中</span></div><div class="line">        style.setAlignment(CellStyle.ALIGN_CENTER);</div><div class="line">        <span class="comment">// 垂直居中</span></div><div class="line">        style.setVerticalAlignment(CellStyle.VERTICAL_CENTER);</div><div class="line">        </div><div class="line">        <span class="comment">// 背景颜色</span></div><div class="line">        setBackgroundColor(style, IndexedColors.YELLOW.index);</div><div class="line">        </div><div class="line">        <span class="comment">// 字体</span></div><div class="line">        style.setFont(getFont(<span class="number">12</span>, IndexedColors.BLUE_GREY.index));</div><div class="line">        </div><div class="line">        <span class="comment">// 数据格式</span></div><div class="line">        style.setDataFormat(workbook.createDataFormat().getFormat(<span class="string">"GENERAL"</span>));</div><div class="line">        </div><div class="line">        <span class="comment">// 自动换行</span></div><div class="line">        style.setWrapText(<span class="keyword">true</span>);</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> style;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 设置单元格背景颜色</div><div class="line">     * </div><div class="line">     * <span class="doctag">@param</span> style</div><div class="line">     *            单元格样式</div><div class="line">     * <span class="doctag">@param</span> color</div><div class="line">     *            颜色值</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setBackgroundColor</span><span class="params">(CellStyle style, <span class="keyword">short</span> color)</span> </span>&#123;</div><div class="line">        <span class="comment">// 边框设置</span></div><div class="line">        style.setBorderBottom(CellStyle.BORDER_THIN);</div><div class="line">        style.setBorderLeft(CellStyle.BORDER_THIN);</div><div class="line">        style.setBorderRight(CellStyle.BORDER_THIN);</div><div class="line">        style.setBorderTop(CellStyle.BORDER_THIN);</div><div class="line">        <span class="comment">// 边框颜色</span></div><div class="line">        style.setBottomBorderColor(IndexedColors.GREY_25_PERCENT.index);</div><div class="line">        style.setLeftBorderColor(IndexedColors.GREY_25_PERCENT.index);</div><div class="line">        style.setRightBorderColor(IndexedColors.GREY_25_PERCENT.index);</div><div class="line">        style.setTopBorderColor(IndexedColors.GREY_25_PERCENT.index);</div><div class="line">        <span class="comment">// 背景颜色</span></div><div class="line">        style.setFillPattern(CellStyle.SOLID_FOREGROUND);</div><div class="line">        style.setFillForegroundColor(color);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 获取字体</div><div class="line">     * </div><div class="line">     * <span class="doctag">@param</span> fontSize</div><div class="line">     *            字体大小</div><div class="line">     * <span class="doctag">@param</span> fontColor</div><div class="line">     *            字体颜色</div><div class="line">     * <span class="doctag">@return</span> Font</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">private</span> Font <span class="title">getFont</span><span class="params">(<span class="keyword">int</span> fontSize, <span class="keyword">short</span> fontColor)</span> </span>&#123;</div><div class="line">        <span class="comment">// 创建字体</span></div><div class="line">        Font font = workbook.createFont();</div><div class="line">        <span class="comment">// 字体颜色</span></div><div class="line">        font.setColor(fontColor);</div><div class="line">        <span class="comment">// 字体大小</span></div><div class="line">        font.setFontHeightInPoints((<span class="keyword">short</span>) fontSize);</div><div class="line">        <span class="comment">// 字体名称</span></div><div class="line">        <span class="keyword">if</span> (System.getProperty(<span class="string">"os.name"</span>).contains(<span class="string">"Windows"</span>)) &#123;</div><div class="line">            font.setFontName(<span class="string">"Microsoft YaHei"</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> font;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// 数据格式</span></div><div class="line">    <span class="keyword">static</span> &#123;</div><div class="line">        dataFormat = <span class="keyword">new</span> HashMap&lt;Class&lt;?&gt;, String&gt;();</div><div class="line">        dataFormat.put(Short.TYPE, <span class="string">"0"</span>);</div><div class="line">        dataFormat.put(Short.class, <span class="string">"0"</span>);</div><div class="line">        dataFormat.put(Integer.TYPE, <span class="string">"0"</span>);</div><div class="line">        dataFormat.put(Integer.class, <span class="string">"0"</span>);</div><div class="line">        dataFormat.put(Long.TYPE, <span class="string">"0"</span>);</div><div class="line">        dataFormat.put(Long.class, <span class="string">"0"</span>);</div><div class="line">        dataFormat.put(Float.TYPE, <span class="string">"0.00"</span>);</div><div class="line">        dataFormat.put(Float.class, <span class="string">"0.00"</span>);</div><div class="line">        dataFormat.put(Double.TYPE, <span class="string">"0.00"</span>);</div><div class="line">        dataFormat.put(Double.class, <span class="string">"0.00"</span>);</div><div class="line">        dataFormat.put(String.class, <span class="string">"GENERAL"</span>);</div><div class="line">        dataFormat.put(Date.class, <span class="string">"yyyy-MM-dd"</span>);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><span class="topic">POI 依赖</span></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-ooxml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div></pre></td></tr></table></figure>
<p><span class="topic">测试对象清单</span></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> String name;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> local;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> Date birthday;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span> </span>&#123;</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(<span class="keyword">int</span> id, String name, <span class="keyword">boolean</span> local, Date birthday)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.id = id;</div><div class="line">        <span class="keyword">this</span>.name = name;</div><div class="line">        <span class="keyword">this</span>.local = local;</div><div class="line">        <span class="keyword">this</span>.birthday = birthday;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> id;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.id = id;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.name = name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isLocal</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> local;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLocal</span><span class="params">(<span class="keyword">boolean</span> local)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.local = local;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">getBirthday</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> birthday;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBirthday</span><span class="params">(Date birthday)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.birthday = birthday;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><span class="topic">测试清单1</span></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> DateFormat format = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd"</span>);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</div><div class="line">    </div><div class="line">    File excelFile = <span class="keyword">new</span> File(<span class="string">"src/test/resources/test_excel.xlsx"</span>);</div><div class="line">    </div><div class="line">    List&lt;Person&gt; list = <span class="keyword">new</span> ArrayList&lt;Person&gt;();</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">10</span>; i++) &#123;</div><div class="line">        list.add(<span class="keyword">new</span> Person(i, <span class="string">"范忠云"</span> + i, i % <span class="number">2</span> == <span class="number">0</span>, format.parse(<span class="string">"1990-04-0"</span> + i)));</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// 属性与 Excel 列的映射关系</span></div><div class="line">    LinkedHashMap&lt;String, String&gt; mapper = <span class="keyword">new</span> LinkedHashMap&lt;String, String&gt;();</div><div class="line">    mapper.put(<span class="string">"id"</span>, <span class="string">"编号"</span>);</div><div class="line">    mapper.put(<span class="string">"name"</span>, <span class="string">"姓名"</span>);</div><div class="line">    mapper.put(<span class="string">"local"</span>, <span class="string">"本地户口"</span>);</div><div class="line">    mapper.put(<span class="string">"birthday"</span>, <span class="string">"出生日期"</span>);</div><div class="line">    </div><div class="line">    <span class="comment">// 创建一个可写的 Excel 对象</span></div><div class="line">    WritableExcel excel = <span class="keyword">new</span> WritableExcel(list, mapper);</div><div class="line">    </div><div class="line">    <span class="comment">// 写出 Excel 文档文件</span></div><div class="line">    <span class="keyword">boolean</span> success = excel.write(excelFile);</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> (success) &#123;</div><div class="line">        System.out.println(<span class="string">"Excel 生成成功！"</span>);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><span class="topic">测试结果</span></p>
<p><img src="http://i.imgur.com/cBOLTyz.png" alt=""></p>
</div><div class="tags"><a href="/tags/工具类/">工具类</a></div><div class="post-share"></div><div class="post-nav"><a href="/post/memcached-tomcat-session-share.html" class="pre">基于 memcached 的 tomcat 集群之 session 共享</a><a href="/post/poi-excel-read.html" class="next">基于 POI 和反射机制实现通用读取 Excel 表格数据</a></div><div id="comments"><div id="SOHUCS" sid="post/poi-excel-write.html"></div></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">文章目录</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/post/springmvc-dubbo-mybatis-with-cat.html">springmvc+dubbo+mybatis 接入大众点评 CAT 监控平台</a></li><li class="post-list-item"><a class="post-list-link" href="/post/cat-setup.html">搭建大众点评CAT监控平台</a></li><li class="post-list-item"><a class="post-list-link" href="/post/mysql-select-optimization.html">MySQL 查询优化</a></li><li class="post-list-item"><a class="post-list-link" href="/post/mysql-index.html">MySQL 索引</a></li><li class="post-list-item"><a class="post-list-link" href="/post/mysql-explain.html">MySQL Explain 分析 SQL 的执行计划</a></li><li class="post-list-item"><a class="post-list-link" href="/post/mysql-query-cache.html">MySQL 查询缓存</a></li><li class="post-list-item"><a class="post-list-link" href="/post/mysql57-resolve-cmd-net-command.html">解决命令行无法关闭和启动MySQL服务的问题</a></li><li class="post-list-item"><a class="post-list-link" href="/post/mysql57-setup.html">MySQL5.7 安装</a></li><li class="post-list-item"><a class="post-list-link" href="/post/linux-commands.html">程序员必知必会的 Linux Shell 命令</a></li><li class="post-list-item"><a class="post-list-link" href="/post/fastdfs-client.html">FastDFS 客户端工具类</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/缓存/" style="font-size: 15px;">缓存</a> <a href="/tags/MQ/" style="font-size: 15px;">MQ</a> <a href="/tags/开发工具包/" style="font-size: 15px;">开发工具包</a> <a href="/tags/Dubbo/" style="font-size: 15px;">Dubbo</a> <a href="/tags/监控/" style="font-size: 15px;">监控</a> <a href="/tags/FastDFS/" style="font-size: 15px;">FastDFS</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/Java8/" style="font-size: 15px;">Java8</a> <a href="/tags/Eclipse/" style="font-size: 15px;">Eclipse</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/表达式/" style="font-size: 15px;">表达式</a> <a href="/tags/CAS/" style="font-size: 15px;">CAS</a> <a href="/tags/工具类/" style="font-size: 15px;">工具类</a> <a href="/tags/Tomcat/" style="font-size: 15px;">Tomcat</a> <a href="/tags/Jenkins/" style="font-size: 15px;">Jenkins</a> <a href="/tags/JPA/" style="font-size: 15px;">JPA</a> <a href="/tags/ActiveMQ/" style="font-size: 15px;">ActiveMQ</a> <a href="/tags/Memcached/" style="font-size: 15px;">Memcached</a> <a href="/tags/数据库/" style="font-size: 15px;">数据库</a> <a href="/tags/MySQL/" style="font-size: 15px;">MySQL</a> <a href="/tags/Nginx/" style="font-size: 15px;">Nginx</a> <a href="/tags/网络爬虫/" style="font-size: 15px;">网络爬虫</a> <a href="/tags/Redis/" style="font-size: 15px;">Redis</a> <a href="/tags/Spring-Boot/" style="font-size: 15px;">Spring Boot</a> <a href="/tags/RabbitMQ/" style="font-size: 15px;">RabbitMQ</a> <a href="/tags/Solr/" style="font-size: 15px;">Solr</a> <a href="/tags/Spring-Cloud/" style="font-size: 15px;">Spring Cloud</a> <a href="/tags/MyBatis/" style="font-size: 15px;">MyBatis</a> <a href="/tags/Spring/" style="font-size: 15px;">Spring</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/Zookeeper/" style="font-size: 15px;">Zookeeper</a> <a href="/tags/Thymeleaf/" style="font-size: 15px;">Thymeleaf</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">08月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">07月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">04月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">03月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">11月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">09月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">08月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">07月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">06月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">05月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">04月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">02月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">01月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">10月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">09月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">01月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">12月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">11月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">10月 2015</a></li></ul></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">网站地图</a> | <a href="/atom.xml">订阅</a> |<span>主题<a rel="nofollow" target="_blank" href="https://hexo.io/zh-cn/"> Hexo</a><a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake</a> |</span><span>本站总访问量：<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>次</span></p></div></div></div><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?4e375539c063ce29112e53dea9f27aae";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="/js/search.json.js?v=2.0.1"></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.1" async></script><script>window._config = { showScore: true };
(function(){ 
  var appid = 'cyt5nPNL8'; 
  var conf = '5fe2e421f26b9cd1b7c459f7417c85b6'; 
  var width = window.innerWidth || document.documentElement.clientWidth; 
  var nodes =document.getElementsByTagName("head")[0]||document.head||document.documentElement;
  if (width < 960) { 
    window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>'); } 
  else { 
    var loadJs=function(d,a){
      var b=document.createElement("script");b.setAttribute("type","text/javascript");
      b.setAttribute("charset","UTF-8");
      b.setAttribute("src",d);
      if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}
      nodes.appendChild(b)
    };
    loadJs("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})}); 
  } 
  var loadCss = function(cssString){  
    var style=document.createElement("style");  
    style.setAttribute("type", "text/css");  
    if(style.styleSheet){// IE  
        style.styleSheet.cssText = cssString;  
    } else {// w3c  
        var cssText = document.createTextNode(cssString);  
        style.appendChild(cssText);  
    }
    nodes.appendChild(style);
  }
  window.onload=function(){loadCss('.module-hot-topic, .module-cmt-float-bar { display: none !important; } #SOHUCS #SOHU_MAIN .module-cmt-box .post-wrap-w .wrap-action-w .cbox-prompt-w span.prompt-empty-w, #SOHUCS #SOHU_MAIN .module-cmt-float-bar .wrap-cont-w .cont-form-w .form-text-w span.text-null, #SOHUCS #SOHU_MAIN .module-cmt-float-bar .wrap-cont-w .cont-minwidth-w div.cont-comment-w a.comment-link-w, #SOHUCS #SOHU_MAIN .module-cmt-float-bar .wrap-cont-w .cont-minwidth-w div.cont-comment-w span.comment-text-w, #SOHUCS #SOHU_MAIN .module-cmt-footer .section-service-w div.service-wrap-w a:hover, #SOHUCS #SOHU_MAIN .module-cmt-header .section-cbox-w .block-head-w div.header-login, #SOHUCS #SOHU_MAIN .module-cmt-header .section-title-w .title-user-w .user-wrap-w span.wrap-name-w, #SOHUCS #SOHU_MAIN .module-cmt-list .action-click-gw span.click-disable-eg a em.icon-name-bg, #SOHUCS #SOHU_MAIN .module-cmt-list .block-title-gw ul li div.title-name-gw, #SOHUCS #SOHU_MAIN .module-cmt-list .cmt-list-type .cmt-list-number .comment-number span.cy-number, #SOHUCS #SOHU_MAIN .module-cmt-list .cmt-list-type .cmt-list-number span.comment-number, #SOHUCS #SOHU_MAIN .module-cmt-list .cmt-list-type .type-lists li.active, #SOHUCS #SOHU_MAIN .module-cmt-list .msg-wrap-gw .wrap-action-gw .action-click-gw span a:hover, #SOHUCS #SOHU_MAIN .module-cmt-list .picture-box-gw div.box-action-gw a:hover, #SOHUCS #SOHU_MAIN .module-cmt-list .wrap-action-gw .action-click-gw span a:hover em.icon-name-bg, #SOHUCS #SOHU_MAIN .module-cmt-list .wrap-user-gw span.user-name-gw a { color: #40759b !important; } #SOHUCS #SOHU_MAIN .module-cmt-box .post-wrap-w .post-wrap-border-t div.post-wrap-border-t-r, #SOHUCS #SOHU_MAIN .module-cmt-box .post-wrap-w div.post-wrap-border-l, #SOHUCS #SOHU_MAIN .module-cmt-box .post-wrap-w div.post-wrap-border-r { display: none !important; } #SOHUCS #SOHU_MAIN .module-cmt-box .post-wrap-w .post-wrap-border-t div.post-wrap-border-t-l { background: #FFF !important; top: -2px !important; } #SOHUCS #SOHU_MAIN .module-cmt-box .post-wrap-w .wrap-action-w .action-function-w .uploading-wrapper-dw div.wrapper-image-dw, #SOHUCS #SOHU_MAIN .module-cmt-box .post-wrap-w div.post-wrap-main, #SOHUCS #SOHU_MAIN .module-cmt-float-bar .wrap-cont-w .cont-form-w div.form-text-w, #SOHUCS #SOHU_MAIN .module-cmt-header .section-cbox-w .block-head-w div.header-login, #SOHUCS #SOHU_MAIN .module-cmt-list .module-cmt-box .post-wrap-w div.post-wrap-main { border: 1px solid #e6e6e6 !important; border-radius: 20px 20px 20px 20px; margin: 0 !important; } #SOHUCS #SOHU_MAIN .module-cmt-box .post-wrap-w .wrap-action-w .action-issue-w .issue-btn-w a .btn-fw { width: 130px !important; height: 34px !important; line-height: 33px !important; font-size: 17px !important; background: transparent !important; } #SOHUCS #SOHU_MAIN .module-cmt-box .post-wrap-w .wrap-action-w .action-issue-w .issue-btn-w a .btn-fw:before { content: "发表评论"; display: block; border-radius: 20px; width: 100%; height: 100%; color: #FFF; background: #5483b1; -webkit-box-shadow: 0 -1px 4px #5483b1 inset; box-shadow: 0 -1px 10px #5483b1 inset; } #SOHUCS #SOHU_MAIN .module-cmt-box .post-wrap-w .wrap-action-w .action-issue-w .issue-btn-w a:hover .btn-fw:before { color: #40759b; background: #FFF; } #SOHUCS #SOHU_MAIN .module-cmt-list .cmt-list-type .type-lists li{ background: none !important; border-bottom: 1px solid #e6e6e6; } #SOHUCS #SOHU_MAIN .module-cmt-list .cmt-list-type .type-lists li.active { border: 1px solid #e6e6e6; border-radius: 10px 10px 0 0; border-bottom: none; } #SOHUCS #SOHU_MAIN .module-cmt-list .block-title-gw ul li .title-name-gw div.title-name-gw-tag { background: #5483b1 !important; border-radius: 3px; } #SOHUCS #SOHU_MAIN .module-cmt-list .cmt-list-type div.cmt-list-border { background-color: #e6e6e6 !important; } #SOHUCS #SOHU_MAIN .module-cmt-notice ul.nt-list li.nt-item{ border: 1px solid #e6e6e6 !important; } #SOHUCS #SOHU_MAIN .module-cmt-notice ul.nt-list li.nt-item .nt-logo { text-align: center; line-height: 40px; border-radius: 50% !important; background: #e6e6e6 !important; } #SOHUCS #SOHU_MAIN .module-cmt-notice ul.nt-list li.nt-item .nt-logo:before { content: "畅"; font-size: 22px; color: #FFF; } #SOHUCS #SOHU_MAIN .module-cmt-notice ul.nt-list li.nt-item a.nt-text, #SOHUCS #SOHU_MAIN .module-cmt-notice ul.nt-list li.nt-item a.nt-text i { color: #5483b1 !important; }#SOHUCS #SOHU_MAIN .module-cmt-header .section-title-w .title-user-w .user-wrap-w{background:#FFF !important;}');};
})();</script><script src="https://assets.changyan.sohu.com/upload/plugins/plugins.count.js"></script></body></html>